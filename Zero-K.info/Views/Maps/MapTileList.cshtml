@using ZkData
@model IQueryable<ZkData.Resource>
@{
    Layout = "";
}

<style>
    .map-link {
        display: flex;
        color: white;
        position: relative;
        width: 256px;
        height: 256px;
        font-family: "OpenSans", sans-serif;
        overflow: hidden;
    }
    .map-tags {
        position: absolute;
        top: 0.5em;
        left: -20em;
        right: 0.5em;
        opacity: 0;
        transition: 0.5s;
    }
    .map-link:hover .map-tags {
        opacity: 1;
        left: 0.5em;
    }
    .map-tags .tag {
        display: inline-flex;
        background: rgba(0,0,0,0.75);
        padding: 0.1em 0.25em;
        margin-bottom: 0.2em;
        grid-gap: 5px;
    }
    .map-details {
        position: absolute;
        background: rgba(0,0,0,0.75);
        left: 0;
        right: 0;
        bottom: 0;
        padding: 0.5em;
        text-shadow: 2px 2px 5px #000;
    }
    .map-name {
        font-weight: bold;
    }
    .map-author {
        font-size: 12px;
    }
</style>

@foreach (var m in Model)
{
    string featureTag;
    string featureColor;
    if (m.MapSupportLevel >= MapSupportLevel.MatchMaker)
    {
        featureTag = "Matchmaker";
        featureColor = "green";
    }
    else if (m.MapSupportLevel >= MapSupportLevel.Featured)
    {
        featureTag = "Featured";
        featureColor = "gold";
    }
    else if (m.MapSupportLevel >= MapSupportLevel.Supported)
    {
        featureTag = "Supported";
        featureColor = "rgba(0,0,0,1)";
    }
    else
    {
        featureTag = "Unsupported";
        featureColor = "red";
    }
    <a class="map-link" href="@Url.Action("Detail", new { id = m.ResourceID })" 
       style="background: url('/Resources/@m.ThumbnailName'); background-size: 256px 256px;">
        <div class="map-tags">
            @{Html.RenderPartial("MapTags", m);}
        </div>
        <div class="map-details">
            <div class="map-name">@m.InternalName</div>
            <div class="map-author">@m.AuthorName</div>
            <div class="map-rating">
                @Html.Stars(StarType.GreenStarSmall, m.MapRating)
            </div>
        </div>
	    @*<div class='mission fleft'>
          <b>@m.InternalName</b>
          @if (m.MapSupportLevel >= MapSupportLevel.MatchMaker) { 
            <img src="@Url.Content("~/img/star_40_gold.png")" title="Matchmaking pool" alt="Matchmaking pool" style='float:right' />
          } else if (m.MapSupportLevel >= MapSupportLevel.Featured) {
            <img src="@Url.Content("~/img/star_40_silver.png")" title="Featured" alt="Featured" style='float:right' />
          } else if (m.MapSupportLevel >= MapSupportLevel.Supported) {
            <img src="@Url.Content("~/img/star_40_bronze.png")" title="Supported" alt="Supported" style='float:right' />
          }
          <br />
          @m.AuthorName<br />
          <table width="100%">
            <tr>
              <td valign='top'>
                <span style="margin: 0; padding: 0; border: 1px dashed gray; display: table-cell;
                  text-align: center; vertical-align: middle; width: 96px; height: 96px;">
                  <img src='/Resources/@m.ThumbnailName' style="margin:0px;padding:0px;"/>
                </span>
              </td>
              <td valign='top'>
                <table>
                  <tr>
                    <td>
                      Rating:
                    </td>
                    <td>@Html.Stars(StarType.GreenStarSmall, m.MapRating)
                    </td>
                  </tr>
                  <tr>
                    <td>
                      Size:
                    </td>
                    <td>@m.MapWidth x @m.MapHeight
                    </td>
                  </tr>
                  <tr>
                    <td colspan='2'>
                      <small>
                        @{Html.RenderPartial("MapTags", m);}
                      </small>
                    </td>
                  </tr>
                </table>
              </td>
            </tr>
          </table>
        </div>*@

	</a>
}
